version: '3.8'

x-common-config: &common-config
  image: ghcr.io/qinks6/nanobot-docker:latest  # 替换为你的镜像地址
  volumes:
    - ./nanobot:/root/.nanobot
  restart: unless-stopped
  deploy:
    resources:
      limits:
        cpus: '1'
        memory: 1G
      reservations:
        cpus: '0.25'
        memory: 256M

services:
  nanobot-gateway:
    container_name: nanobot-gateway
    <<: *common-config
    command: ["gateway"]
    ports:
      - 18790:18790
  
  nanobot-cli:
    <<: *common-config
    profiles:
      - cli
    command: ["status"]
    stdin_open: true
    tty: true
    deploy: null  # CLI 不需要资源限制
